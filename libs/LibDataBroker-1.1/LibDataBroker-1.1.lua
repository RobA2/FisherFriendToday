assert(LibStub,"LibDataBroker-1.1 requires LibStub")assert(LibStub:GetLibrary("CallbackHandler-1.0",true),"LibDataBroker-1.1 requires CallbackHandler-1.0")local a,b=LibStub:NewLibrary("LibDataBroker-1.1",4)if not a then return end;b=b or 0;a.callbacks=a.callbacks or LibStub:GetLibrary("CallbackHandler-1.0"):New(a)a.attributestorage,a.namestorage,a.proxystorage=a.attributestorage or{},a.namestorage or{},a.proxystorage or{}local c,d,e=a.attributestorage,a.namestorage,a.callbacks;if b<2 then a.domt={__metatable="access denied",__index=function(self,f)return c[self]and c[self][f]end}end;if b<3 then a.domt.__newindex=function(self,f,g)if not c[self]then c[self]={}end;if c[self][f]==g then return end;c[self][f]=g;local h=d[self]if not h then return end;e:Fire("LibDataBroker_AttributeChanged",h,f,g,self)e:Fire("LibDataBroker_AttributeChanged_"..h,h,f,g,self)e:Fire("LibDataBroker_AttributeChanged_"..h.."_"..f,h,f,g,self)e:Fire("LibDataBroker_AttributeChanged__"..f,h,f,g,self)end end;if b<2 then function a:NewDataObject(h,i)if self.proxystorage[h]then return end;if i then assert(type(i)=="table","Invalid dataobj, must be nil or a table")self.attributestorage[i]={}for j,k in pairs(i)do self.attributestorage[i][j]=k;i[j]=nil end end;i=setmetatable(i or{},self.domt)self.proxystorage[h],self.namestorage[i]=i,h;self.callbacks:Fire("LibDataBroker_DataObjectCreated",h,i)return i end end;if b<1 then function a:DataObjectIterator()return pairs(self.proxystorage)end;function a:GetDataObjectByName(l)return self.proxystorage[l]end;function a:GetNameByDataObject(m)return self.namestorage[m]end end;if b<4 then local n=pairs(c)function a:pairs(o)local p=type(o)assert(p=="string"or p=="table","Usage: ldb:pairs('dataobjectname') or ldb:pairs(dataobject)")local i=self.proxystorage[o]or o;assert(c[i],"Data object not found")return n,c[i],nil end;local q=ipairs(c)function a:ipairs(o)local p=type(o)assert(p=="string"or p=="table","Usage: ldb:ipairs('dataobjectname') or ldb:ipairs(dataobject)")local i=self.proxystorage[o]or o;assert(c[i],"Data object not found")return q,c[i],0 end end